"use strict";angular.module("iframeCommunicationApp",[]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("iframeCommunicationApp").controller("MainCtrl",["$rootScope","$scope","postMessageService",function(e,s,n){s.messages=n.messages(),s.sendMessage=function(){n.outgoing(s.outgoingMessage),s.outgoingMessage=""}}]),angular.module("iframeCommunicationApp").directive("ngPostMessage",["$window","postMessageService",function(e,s){return{restrict:"A",controller:["$scope","$attrs","postMessageService",function(e){e.$on("outgoingMessage",function(s,n){if(e.sender){var o=JSON.stringify({status:200,message:n});e.sender.postMessage(o,"*")}})}],link:function(n){n.sendMessageToService=function(e){if(e&&e.data){var o=null;n.sender=e.source;try{o=angular.fromJson(e.data)}catch(a){o={message:e.data},"connect"===o.message&&(o.message="Successfully connected")}s.messages(o.message)}},angular.element(e).bind("message",n.sendMessageToService)}}}]),angular.module("iframeCommunicationApp").factory("postMessageService",["$rootScope",function(e){var s=[],n={messages:function(n){return n&&(s.push(n),e.$apply()),s},outgoing:function(s){e.$broadcast("outgoingMessage",s)}};return n}]);